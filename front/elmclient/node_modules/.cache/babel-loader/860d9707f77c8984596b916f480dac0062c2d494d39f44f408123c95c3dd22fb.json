{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport Footer from '../components/Footer.vue';\nexport default {\n  name: 'Payment',\n  data() {\n    return {\n      orderId: this.$route.query.orderId,\n      orders: {\n        business: {}\n      },\n      user: {},\n      isShowDetailet: false\n    };\n  },\n  created() {\n    this.user = this.$getSessionStorage('user');\n\n    //跟新积分信息\n    this.$axios.post('IntegralController/getIntegral', this.$qs.stringify({\n      userId: this.user.userId\n    })).then(response => {\n      this.user.integral = response.data;\n    }).catch(error => {\n      console.error(error);\n    });\n    this.$axios.post('OrdersController/getOrdersById', this.$qs.stringify({\n      orderId: this.orderId\n    })).then(response => {\n      this.orders = response.data;\n    }).catch(error => {\n      console.error(error);\n    });\n  },\n  mounted() {\n    //这里的代码是实现：一旦路由到在线支付组件，就不能回到订单确认组件。\n    //先将当前url添加到history对象中\n    //history.pushState(null, null, document.URL);\n    //popstate事件能够监听history对象的变化\n    window.onpopstate = () => {\n      this.$router.push({\n        path: '/index'\n      });\n    };\n  },\n  destroyed() {\n    window.onpopstate = null;\n  },\n  methods: {\n    detailetShow() {\n      this.isShowDetailet = !this.isShowDetailet;\n    },\n    payment() {\n      //支付订单\n      this.$axios.post('OrdersController/payOrders', this.$qs.stringify({\n        userId: this.user.userId,\n        orderId: this.orders.orderId,\n        orderTotal: this.orders.orderTotal\n      })).then(response => {\n        if (response.data > 0) {\n          //alert('订单支付成功！');\n        } else {\n          alert('订单支付失败！');\n        }\n      }).catch(error => {\n        console.error(error);\n      });\n      this.$router.push({\n        path: '/index'\n      });\n    }\n  },\n  components: {\n    Footer\n  }\n};","map":{"version":3,"names":["Footer","name","data","orderId","$route","query","orders","business","user","isShowDetailet","created","$getSessionStorage","$axios","post","$qs","stringify","userId","then","response","integral","catch","error","console","mounted","window","onpopstate","$router","push","path","destroyed","methods","detailetShow","payment","orderTotal","alert","components"],"sources":["D:\\Homework\\ProDesIntermediate\\codes\\front\\elmclient\\src\\views\\Payment.vue"],"sourcesContent":["<template>\n\t<div class=\"wrapper\">\n\t\t<!--头部-->\n\t\t<header>\n\t\t\t<p> 在线支付</p>\n\t\t</header>\n\t\t<!--订单信息-->\n\t\t<h3>订单信息：</h3>\n\t\t<div class=\"info\">\n\t\t\t<p>\n\t\t\t\t{{orders.business.businessName}}\n\t\t\t\t<i class=\"fa fa-caret-down\" @click=\"detailetShow\"></i>\n\t\t\t</p>\n\t\t\t<p>\n\t\t\t\t&#165;{{orders.orderTotal}}\n\t\t\t</p>\n\t\t</div>\n\t\t<!--订单明细-->\n\t\t<ul class=\"order-detail\" v-show=\"isShowDetailet\">\n\t\t\t<li v-for=\"item in orders.list\">\n\t\t\t\t<p>{{item.food.foodName}} x {{item.quantity}}</p>\n\t\t\t\t<p>&#165;{{item.food.foodPrice*item.quantity}}</p>\n\t\t\t</li>\n\t\t\t<li>\n\t\t\t\t<p>配送费</p>\n\t\t\t\t<p>&#165;{{orders.business.deliveryPrice}}</p>\n\t\t\t</li>\n\t\t</ul>\n\t\t<!--支付方式-->\n\t\t<ul class=\"payment\">\n\t\t\t<li>\n\t\t\t\t<img src=\"../assets/alipay.png\">\n\t\t\t\t<i class=\"fa fa-check-circle\"></i>\n\t\t\t</li>\n\t\t\t<li>\n\t\t\t\t<img src=\"../assets/wechat.png\">\n\t\t\t</li>\n\t\t</ul>\n\t\t<div class=\"button\" @click=\"payment\">\n\t\t\t<button>确认支付</button>\n\t\t</div>\n\t\t<!--底部菜单-->\n\t\t<Footer></Footer>\n\t</div>\n</template>\n\n<script>\n\timport Footer from '../components/Footer.vue';\n\n\texport default {\n\t\tname: 'Payment',\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\torderId: this.$route.query.orderId,\n\t\t\t\torders: {\n\t\t\t\t\tbusiness: {}\n\t\t\t\t},\n\t\t\t\tuser: {},\n\t\t\t\tisShowDetailet: false\n\t\t\t}\n\t\t},\n\t\tcreated() {\n\t\t\tthis.user = this.$getSessionStorage('user');\n\t\t\t\n\t\t\t//跟新积分信息\n\t\t\tthis.$axios.post('IntegralController/getIntegral', this.$qs.stringify({\n\t\t\t\tuserId: this.user.userId\n\t\t\t})).then(response => {\n\t\t\t\tthis.user.integral = response.data;\n\t\t\t}).catch(error => {\n\t\t\t\tconsole.error(error);\n\t\t\t});\n\t\t\t\n\t\t\tthis.$axios.post('OrdersController/getOrdersById', this.$qs.stringify({\n\t\t\t\torderId: this.orderId\n\t\t\t})).then(response => {\n\t\t\t\tthis.orders = response.data;\n\t\t\t}).catch(error => {\n\t\t\t\tconsole.error(error);\n\t\t\t});\n\t\t},\n\t\tmounted() {\n\t\t\t//这里的代码是实现：一旦路由到在线支付组件，就不能回到订单确认组件。\n\t\t\t//先将当前url添加到history对象中\n\t\t\t//history.pushState(null, null, document.URL);\n\t\t\t//popstate事件能够监听history对象的变化\n\t\t\twindow.onpopstate = () => {\n\t\t\t\tthis.$router.push({\n\t\t\t\t\tpath: '/index'\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tdestroyed() {\n\t\t\twindow.onpopstate = null;\n\t\t},\n\t\tmethods: {\n\t\t\tdetailetShow() {\n\t\t\t\tthis.isShowDetailet = !this.isShowDetailet;\n\t\t\t},\n\t\t\tpayment() {\r\n\t\t\t\t\r\n\t\t\t\t//支付订单\r\n\t\t\t\tthis.$axios.post('OrdersController/payOrders', this.$qs.stringify({\r\n\t\t\t\t\tuserId: this.user.userId,\r\n\t\t\t\t\torderId: this.orders.orderId,\r\n\t\t\t\t\torderTotal: this.orders.orderTotal\r\n\t\t\t\t})).then(response => {\r\n\t\t\t\t\tif (response.data > 0) {\r\n\t\t\t\t\t\t//alert('订单支付成功！');\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\talert('订单支付失败！');\r\n\t\t\t\t\t}\r\n\t\t\t\t}).catch(error => {\r\n\t\t\t\t\tconsole.error(error);\r\n\t\t\t\t});\n\t\t\t\tthis.$router.push({\n\t\t\t\t\tpath: '/index'\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tcomponents: {\n\t\t\tFooter\n\t\t}\n\t}\n</script>\n\n<style scoped>\n\t/**总容器*/\n\t.wrapper {\n\t\twidth: 100%;\n\t\theight: 100%;\n\t}\n\n\t/**头部*/\n\t.wrapper header {\n\t\twidth: 100%;\n\t\theight: 12vw;\n\t\tbackground-color: #0097FF;\n\n\t\tcolor: #fff;\n\t\tfont-size: 4.8vw;\n\n\t\tposition: fixed;\n\t\tleft: 0;\n\t\ttop: 0;\n\t\tz-index: 1000;\n\t\t/*提高头部层次，覆盖同样离开文档流的红色图标和图片*/\n\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\n\t}\n\n\t/*****订单信息*****/\n\t.wrapper h3 {\n\t\tmargin-top: 12vw;\n\t\tbox-sizing: border-box;\n\t\tpadding: 4vw 4vw 0;\n\n\t\tfont-size: 4vw;\n\t\tfont-weight: 300;\n\t\tcolor: #999;\n\t}\n\n\t.wrapper .info {\n\t\tbox-sizing: border-box;\n\t\tpadding: 4vw;\n\t\tfont-size: 4vw;\n\t\tcolor: #666;\n\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: space-between;\n\t}\n\n\t.wrapper .info p:last-child {\n\t\tcolor: orangered;\n\t}\n\n\t/*****订单明细*****/\n\t.wrapper .order-detail {\n\t\twidth: 100%;\n\n\t}\n\n\t.wrapper .order-detail li {\n\t\tbox-sizing: border-box;\n\t\tpadding: 1vw 4vw;\n\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: space-between;\n\t}\n\n\t.wrapper .order-detail li p {\n\t\tfont-size: 3vw;\n\t\tcolor: #666;\n\t}\n\n\t/*支付方式*/\n\n\t.wrapper .payment {\n\t\twidth: 100%;\n\t}\n\n\t.wrapper .payment li {\n\t\twidth: 100%;\n\t\tbox-sizing: border-box;\n\t\tpadding: 4vw;\n\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t}\n\n\t.wrapper .payment li img {\n\t\twidth: 33vw;\n\t\theight: 8.9vw;\n\n\t}\n\n\t.wrapper .payment li .fa-check-circle {\n\t\tfont-size: 5vw;\n\t\tcolor: #38CA73;\n\t}\n\n\t.wrapper .button {\n\t\twidth: 100%;\n\t\tbox-sizing: border-box;\n\t\tpadding: 4vw;\n\t}\n\n\t.wrapper .button button {\n\t\twidth: 100%;\n\t\theight: 10vw;\n\t\tborder: none;\n\t\toutline: none;\n\t\tborder-radius: 4px;\n\t\tbackground-color: #38CA73;\n\t\tcolor: #fff;\n\t\tcursor: pointer;\n\t}\n</style>\n"],"mappings":";AA+CC,OAAOA,MAAK,MAAO,0BAA0B;AAE7C,eAAe;EACdC,IAAI,EAAE,SAAS;EACfC,IAAIA,CAAA,EAAG;IACN,OAAO;MACNC,OAAO,EAAE,IAAI,CAACC,MAAM,CAACC,KAAK,CAACF,OAAO;MAClCG,MAAM,EAAE;QACPC,QAAQ,EAAE,CAAC;MACZ,CAAC;MACDC,IAAI,EAAE,CAAC,CAAC;MACRC,cAAc,EAAE;IACjB;EACD,CAAC;EACDC,OAAOA,CAAA,EAAG;IACT,IAAI,CAACF,IAAG,GAAI,IAAI,CAACG,kBAAkB,CAAC,MAAM,CAAC;;IAE3C;IACA,IAAI,CAACC,MAAM,CAACC,IAAI,CAAC,gCAAgC,EAAE,IAAI,CAACC,GAAG,CAACC,SAAS,CAAC;MACrEC,MAAM,EAAE,IAAI,CAACR,IAAI,CAACQ;IACnB,CAAC,CAAC,CAAC,CAACC,IAAI,CAACC,QAAO,IAAK;MACpB,IAAI,CAACV,IAAI,CAACW,QAAO,GAAID,QAAQ,CAAChB,IAAI;IACnC,CAAC,CAAC,CAACkB,KAAK,CAACC,KAAI,IAAK;MACjBC,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC;IACrB,CAAC,CAAC;IAEF,IAAI,CAACT,MAAM,CAACC,IAAI,CAAC,gCAAgC,EAAE,IAAI,CAACC,GAAG,CAACC,SAAS,CAAC;MACrEZ,OAAO,EAAE,IAAI,CAACA;IACf,CAAC,CAAC,CAAC,CAACc,IAAI,CAACC,QAAO,IAAK;MACpB,IAAI,CAACZ,MAAK,GAAIY,QAAQ,CAAChB,IAAI;IAC5B,CAAC,CAAC,CAACkB,KAAK,CAACC,KAAI,IAAK;MACjBC,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC;IACrB,CAAC,CAAC;EACH,CAAC;EACDE,OAAOA,CAAA,EAAG;IACT;IACA;IACA;IACA;IACAC,MAAM,CAACC,UAAS,GAAI,MAAM;MACzB,IAAI,CAACC,OAAO,CAACC,IAAI,CAAC;QACjBC,IAAI,EAAE;MACP,CAAC,CAAC;IACH;EACD,CAAC;EACDC,SAASA,CAAA,EAAG;IACXL,MAAM,CAACC,UAAS,GAAI,IAAI;EACzB,CAAC;EACDK,OAAO,EAAE;IACRC,YAAYA,CAAA,EAAG;MACd,IAAI,CAACtB,cAAa,GAAI,CAAC,IAAI,CAACA,cAAc;IAC3C,CAAC;IACDuB,OAAOA,CAAA,EAAG;MAET;MACA,IAAI,CAACpB,MAAM,CAACC,IAAI,CAAC,4BAA4B,EAAE,IAAI,CAACC,GAAG,CAACC,SAAS,CAAC;QACjEC,MAAM,EAAE,IAAI,CAACR,IAAI,CAACQ,MAAM;QACxBb,OAAO,EAAE,IAAI,CAACG,MAAM,CAACH,OAAO;QAC5B8B,UAAU,EAAE,IAAI,CAAC3B,MAAM,CAAC2B;MACzB,CAAC,CAAC,CAAC,CAAChB,IAAI,CAACC,QAAO,IAAK;QACpB,IAAIA,QAAQ,CAAChB,IAAG,GAAI,CAAC,EAAE;UACtB;QAAA,CACD,MAAO;UACNgC,KAAK,CAAC,SAAS,CAAC;QACjB;MACD,CAAC,CAAC,CAACd,KAAK,CAACC,KAAI,IAAK;QACjBC,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC;MACrB,CAAC,CAAC;MACF,IAAI,CAACK,OAAO,CAACC,IAAI,CAAC;QACjBC,IAAI,EAAE;MACP,CAAC,CAAC;IACH;EACD,CAAC;EACDO,UAAU,EAAE;IACXnC;EACD;AACD"},"metadata":{},"sourceType":"module","externalDependencies":[]}